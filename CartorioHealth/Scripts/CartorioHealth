O CartorioHealth é um script automatizado desenvolvido em PowerShell com a finalidade de realizar verificações de integridade e correções automáticas nas estações de trabalho de cartórios. Ele foi projetado para ser executado automaticamente no momento da inicialização do sistema operacional, por meio de uma tarefa agendada, rodando com a conta SYSTEM, o que garante permissões suficientes para executar ações críticas sem depender da intervenção do usuário.

Ao iniciar sua execução, o script cria automaticamente a estrutura de diretórios necessária em C:\ProgramData\CartorioHealth\Logs, onde são armazenados os arquivos de log. Cada execução gera registros detalhados contendo data, hora e descrição de todas as verificações realizadas e ações executadas. Os logs são organizados por data e mantidos por até 30 dias, sendo excluídos automaticamente após esse período, garantindo organização e controle de armazenamento.

O script realiza a verificação da conectividade de rede de forma dinâmica, sem utilização de endereços IP fixos, garantindo compatibilidade com diferentes ambientes de cartório. Ele valida se o computador recebeu endereço IP via DHCP, verifica a disponibilidade do gateway padrão e testa a resolução de nomes DNS, registrando no log se cada etapa foi concluída com sucesso ou se apresentou falha.

Também é feita a sincronização automática de data e hora do sistema, utilizando os serviços nativos do Windows. Essa etapa é fundamental para evitar falhas em sistemas internos, autenticação de usuários e comunicação com servidores externos, sendo o resultado da sincronização devidamente registrado no log.

Um dos principais focos do CartorioHealth é a estabilidade do serviço de impressão. O script verifica o status do serviço Spooler de Impressão e, caso identifique que o serviço está parado ou com falhas, realiza automaticamente a reinicialização. Além disso, ele valida a existência de impressoras instaladas e drivers carregados no sistema, prevenindo erros comuns de impressão que geram chamados recorrentes nos cartórios.

Todas as ações executadas pelo script são registradas em um log narrativo e auditável, com mensagens claras e objetivas, indicando se cada verificação foi concluída com sucesso ou se houve necessidade de correção. Esse modelo de registro facilita o diagnóstico técnico, a auditoria de funcionamento e a comprovação de que as rotinas de manutenção preventiva estão sendo executadas corretamente, reduzindo falhas operacionais e aumentando a confiabilidade do ambiente de trabalho.
