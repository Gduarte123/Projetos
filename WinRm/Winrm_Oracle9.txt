#Comando para acessar o ambiente:

#cd /root/WinRm/winrm-llm-bot && source /root/WinRm/winrm-env/bin/activate && python3 main.py


#!/bin/bash
set -e

# ===== CONFIG =====
REPO_URL="https://github.com/GabrielOliveiraArgon/WinRm.git"
BASE_DIR="/root/WinRm"
WIN_USER="winrmuser"
WIN_PASS="S3nh@1995"

# ===== DEPENDENCIAS (SEM UPDATE) =====
dnf -y install git python3 python3-pip python3-virtualenv nmap || true

# ===== CLONE =====
if [ ! -d "$BASE_DIR" ]; then
  git clone "$REPO_URL" "$BASE_DIR"
fi

cd "$BASE_DIR"

# ===== VENV =====
python3 -m venv winrm-env
source winrm-env/bin/activate

# ===== DEPENDENCIAS PYTHON =====
pip install --upgrade pip
pip install pywinrm requests python-nmap python-dotenv

# ===== VARIAVEIS FIXAS =====
grep -q "WIN_USER=winrmuser" /root/.bashrc || cat <<EOF >> /root/.bashrc

# WinRM FIXO
export WIN_USER=$WIN_USER
export WIN_PASS='$WIN_PASS'
EOF

source /root/.bashrc

# ===== PERMISSOES =====
chmod -R 700 "$BASE_DIR"

echo "INSTALAÇÃO CONCLUÍDA"
echo "Execute:"
echo "cd /root/WinRm/winrm-llm-bot && source /root/WinRm/winrm-env/bin/activate && python3 main.py"

